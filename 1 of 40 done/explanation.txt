////////////////РЕШАЕМ ЗАЛИВКОЙ
Как узнать, что здесь граница - и не переходить  на соседний квадрат?

Граница между 2 кдетками есть тогда и только тогда, когда различается множество прямоугольников, покрывающих эти две клетки.

Размер заливаемого поля. 30000х30000 - в худшем случае. 900 млн, за 1 сек не возможно посещение всех клеток.

Применим сжатие координат. Тогда x - координат не больше 2n, так же для y. => (2n+1)*(2n+1) - нашее поле, поскольку все заключено в большу. площадь.

Как задавать, каким прямоугольникам принадлежит заданный квадрат? Можем для каждой клетки хранить набор в явном виде, например в векторе.